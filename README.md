# 半自动人卫智网答题工具

Power by trae and GLM-4.5

> **重要声明**：本工具仅适用于人卫智网且实测于题目顺序固定的管理非常宽松的只有时间限制的模拟考试类型试卷。严禁用于任何形式的正式考试作弊，本工具仅用于应对浪费时间的形式主义做题场景。
>
> **注意**：本工具有一定的人为操作成本，为半自动化工具，对于自动答题功能仅**自动根据answers.txt中的格式化预置答案选择每道一页只有一题的单选题的答案并根据题号导航到下一题**。
> - 自动操作部分：批量捕获题目html、批量转换html为格式化文本、读取特定格式答案并自动填写特定题目。
> - 手动操作部分：登录和调整到答题页面、传输题目内容给AI获取答案、处理AI返回的答案为特定格式。

## 工具组成

1. **main.py** - 集成主程序，解决使用不同脚本时重复登录问题
2. **exam-capture.py** - 遍历试卷每一页并捕获HTML
3. **html-to-txt.py** - 将HTML处理为TXT文件
4. **exam-answer.py** - 根据预置答案批量答题
5. **test/实际答案数量检测.py** - 检查文件中的大写字母数量

### 主程序特点

**main.py** 是本工具的集成主程序，具有以下特点：

- **统一界面**：提供友好的菜单系统，用户可以选择执行特定功能或完整流程
- **浏览器状态保持**：程序运行期间浏览器保持打开状态，避免多次登录
- **自动初始化**：启动时自动打开浏览器并导航到考试登录页面
- **灵活操作**：用户可以单独执行某个功能，也可以按顺序执行完整流程
- **资源管理**：自动清理临时文件和用户数据目录，不留下垃圾文件

**使用主程序的优势**：
- 只需登录一次，浏览器在整个操作过程中保持打开状态
- 无需多次打开和关闭浏览器，提高操作效率
- 提供统一的操作界面，简化使用流程
- 自动管理浏览器资源，避免冲突和错误

## 注意事项

1. 确保已安装Python和所需依赖库：
   ```bash
   pip install -r requirements.txt
   ```

2. 确保已安装Chrome浏览器和对应版本的ChromeDriver（已包含在 `chromedriver-win64` 目录中）。

3. 在运行脚本前准备好账号密码用于登录。

4. 页面可能更改布局，需要根据实际情况调整代码适配新布局。

## 使用步骤

### 使用主程序（推荐）

运行 `main.py` 脚本：

```bash
python main.py
```

这个脚本会：
1. 自动打开浏览器并导航到考试登录页面
2. 提示用户手动登录并导航到答题页面
3. 显示功能菜单，用户可以选择以下功能：
   - 批量捕获所有题目的HTML
   - 批量格式化题目HTML为TXT
   - 批量选择答案
   - 关闭浏览器并退出

**主程序使用流程**：
1. 运行 `main.py`，浏览器自动打开到登录页面
2. 手动登录并导航到答题页面，按Enter键继续
3. 选择功能1（批量捕获所有题目的HTML）
4. 将生成的 `questions.txt` 文件内容传输给AI获取答案
5. 将AI返回的答案处理为 `answers.txt` 格式
6. 返回主程序菜单，选择功能3（批量选择答案）
7. 完成后选择功能4（关闭浏览器并退出）

**优势**：整个过程中浏览器保持打开状态，无需多次登录，操作更加便捷高效。


---

## 传统使用方法（不推荐）

### 第一步：捕获题目HTML

运行 `exam-capture.py` 脚本：

```bash
python exam-capture.py
```

这个脚本会：
1. 打开人卫智网网页
2. 手动调整到答题界面后回车
3. 删除之前捕获的文件，遍历每一道题目，捕获新的HTML并保存到 `captured_html` 目录

### 第二步：将HTML转换为TXT

运行 `html-to-txt.py` 脚本：

```bash
python html-to-txt.py
```

这个脚本会：
1. 读取 `captured_html` 目录中的所有HTML文件
2. 提取题目和选项内容
3. 保存为TXT文件到项目根目录的 `questions.txt`

### 第三步：获取AI答案

将 `questions.txt` 文件内容手动传输给AI：[AI批量答题提示词及操作简介.txt](./AI批量答题提示词及操作简介.txt)

将AI返回的答案复制到 `test/答案预处理.txt`（随意位置，目的是手动格式化答案），然后建议使用文本替换方法简单处理为项目根目录的 `answers.txt` 特定格式。

### 第四步：验证答案数量（可选）

运行 `test/实际答案数量检测.py` 脚本：

```bash
python test/实际答案数量检测.py
```

这个脚本会：
1. 提示用户输入要检查的文件路径（**可以检查任意文件中的大写字母数量**）
2. 如果用户没有输入路径，则默认检查项目根目录下的 `answers.txt` 文件
3. 统计指定文件中的大写字母数量（每个答案通常是一个大写字母）
4. 显示每行内容及其包含的大写字母数量
5. 输出文件中的大写字母总数，帮助验证答案数量是否与题目数量匹配

**使用示例**：
- 检查其他文件：运行脚本后输入完整文件路径，如 `C:\path\to\your\file.txt`
- 检查默认答案文件：运行脚本提示输入路径直接回车，不输入路径

### 第五步：自动填写答案

运行 `exam-answer.py` 脚本：

```bash
python exam-answer.py
```

这个脚本会：
1. 打开人卫智网网页
2. 手动调整到答题界面
3. 读取 `answers.txt` 文件中的答案
4. 自动选择每道**一页只有一题的单选题**的答案并根据题号导航到下一题

<br>
<br>
<br>

<p style="color: #FF6B6B; font-weight: bold; text-align: center; font-size: 1.1em;">单页多题的自己选一下吧~答案都给你了~<br>~(￣▽￣)~*</p>

<br>
<br>
<br>


### 程序运行视频演示（整活向）

<video width="800" height="450" controls>
  <source src="https://raw.githubusercontent.com/xuan12345678900/semi-automatic-RenWeiZhiWang-answer-tool/main/video/开了.mp4" type="video/mp4">
  您的浏览器不支持HTML5视频播放，请点击下方链接下载观看。
</video>

该视频简单展示了正常情况的使用流程

## 故障排除

1. **无法找到元素**：如果脚本提示无法找到某个元素，可能需要检查页面结构并更新选择器。

2. **页面加载超时**：如果页面加载较慢，可以增加脚本中的等待时间。

3. **答案格式问题**：确保answers.txt中的答案格式与脚本期望的格式一致。
   
   **标准格式**：
   ```
   1.D
   2.B
   3.A
   ```
   
   每行一个答案，格式为"题号.选项"，其中选项为大写字母。

4. **ChromeDriver版本不匹配**：如果提示ChromeDriver版本不匹配，需要下载与Chrome浏览器版本对应的ChromeDriver并替换 `chromedriver-win64` 目录中的文件。